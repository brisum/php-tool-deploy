<?php

error_reporting(E_ALL);
ini_set('display_errors', 1);

header("Content-Type:text/html");

$dir = realpath(dirname(__FILE__));
$parameters = file_get_contents($dir . '/../../../app/config/parameters.yml');
$config = [];

$parameters = array_filter(array_map('trim', explode("\n", $parameters)));
foreach ($parameters as $item) {
    $pieces = array_map('trim', explode(':', $item));
    if (2 !== count($pieces)) {
        continue;
    }

    list($key, $value) = $pieces;
    $config[$key] = $value;
}

if (isset($_GET['action']) && 'import' == $_GET['action']) {
    require('import/functions.php');
    db_import($config['database_host'], $config['database_name'], $config['database_user'], $config['database_password']);
}
if (isset($_GET['action']) && 'export' == $_GET['action']) {
    require('export/functions.php');
    db_export($config['database_host'], $config['database_name'], $config['database_user'], $config['database_password']);
}
